# DATA FLOW DIAGRAM - STREAMLINED VERSION
## Silay DRRMO Flood Monitoring System with GIS
### Focus: Essential Processes & Unique System Logic

---

## TABLE OF CONTENTS
1. [Context Diagram (Level 0)](#context-diagram-level-0)
2. [Level 1 DFD - System Overview](#level-1-dfd---system-overview)
3. [Level 2 DFD - Core Processes](#level-2-dfd---core-processes)
4. [Level 3 DFD - Critical Sub-Processes](#level-3-dfd---critical-sub-processes)
5. [Level 4 DFD - AND-Based Risk Logic](#level-4-dfd---and-based-risk-logic)
6. [Data Dictionary](#data-dictionary)

---

## CONTEXT DIAGRAM (Level 0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Admin User    â”‚
â”‚  (Regular User) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Login credentials, commands, settings
         â”‚
         â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                            â”‚
    â”‚    0.0 Flood Risk Management &            â”‚
    â”‚        Monitoring System                   â”‚
    â”‚                                            â”‚
    â””â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
      â”‚                                      â”‚
      â”‚ Dashboards, reports,                 â”‚
      â”‚ analytics, alerts                    â”‚
      â”‚                                      â”‚
      â†“                                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Open-Meteo   â”‚â”€â”€Rainfall dataâ”€â”€â”€â”€>â”‚                â”‚
â”‚     API      â”‚                    â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚                â”‚
                                    â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                â”‚
â”‚ WorldTides   â”‚â”€â”€Tide level dataâ”€â”€>â”‚   EXTERNAL     â”‚
â”‚     API      â”‚                    â”‚     DATA       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   SOURCES      â”‚
                                    â”‚                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚                â”‚
â”‚  MGB GIS     â”‚<â”€â”€GIS requestsâ”€â”€â”€â”€â”€â”‚                â”‚
â”‚  Data Source â”‚â”€â”€Boundaries/mapsâ”€â”€>â”‚                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### External Entities:
- **Admin User / Regular User**: System operators and stakeholders
- **Open-Meteo API**: Weather and rainfall data provider (free API)
- **WorldTides API**: Tide level data provider (authenticated)
- **MGB GIS Data Source**: Geographic Information System data repository

---

## LEVEL 1 DFD - SYSTEM OVERVIEW

```
                                    LEVEL 1 - MAIN PROCESSES
                                    
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin/User  â”‚â”€â”€â”€â”€Login credentialsâ”€â”€â”€â”€>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚  1.0 AUTHENTICATEâ”‚
       â”‚                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                            â”‚
       â”‚                                            â†“ Session token
       â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                    â”‚   D1 Users    â”‚
       â”‚                                    â”‚ D13 Login Log â”‚
       â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Map request                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  2.0 FLOOD RISK     â”‚
                                           â”‚  MAP ASSESSMENT     â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”‚                     â”‚
       â”‚ Interactive map + risk data       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                          â”‚
       â”‚                                          â†“ Assessment data
       â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                   â”‚   D2 Barangays  â”‚
       â”‚                                   â”‚ D3 Flood Zones  â”‚
       â”‚                                   â”‚ D4 Assessments  â”‚
       â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Report request                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  3.0 GENERATING     â”‚
                                          â”‚  REPORTS & CERTS    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”‚                     â”‚
       â”‚ PDF Reports/Certificates          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                          â”‚
       â”‚                                          â†“ Report records
       â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                   â”‚  D5 Reports     â”‚
       â”‚                                   â”‚ D6 Certificates â”‚
       â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Dashboard view                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  4.0 MONITORING     â”‚
                                          â”‚  RAINFALL/TIDE      â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”‚                     â”‚
       â”‚ Real-time flood risk alerts       â””â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                      â”‚   â”‚   â”‚
       â”‚                                      â†“   â†“   â†“
       â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                            â”‚  D7 Rainfall             â”‚
       â”‚                            â”‚  D8 Weather              â”‚
       â”‚                            â”‚  D9 Tide Levels          â”‚
       â”‚                            â”‚  D10 Flood Records       â”‚
       â”‚                            â”‚  D11 Benchmark Settings  â”‚
       â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                      â†‘   â†‘
       â”‚                                      â”‚   â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚   â”‚
   â”‚ Open-Meteo APIâ”‚â”€â”€â”€â”€â”€Rainfall dataâ”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
   â”‚WorldTides API â”‚â”€â”€â”€â”€â”€Tide dataâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin User  â”‚â”€â”€â”€â”€User mgmt commandsâ”€â”€â”€â”€>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚  5.0 USER        â”‚
       â”‚                                   â”‚  MANAGEMENT      â”‚
       â”‚<â”€â”€â”€â”€â”€â”€User list/approvalsâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                  â”‚
       â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                             â”‚
       â”‚                                             â†“
       â”‚                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                     â”‚   D1 Users   â”‚
       â”‚                                     â”‚ D12 Activity â”‚
       â”‚                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ View activity logs                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  6.0 ACTIVITY    â”‚
                                           â”‚  HISTORY MGMT    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”‚                  â”‚
       â”‚ Activity reports                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                              â”‚
       â”‚                                              â†“
       â”‚                                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                      â”‚ D12 Activity â”‚
       â”‚                                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”‚ Adjust thresholds                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚  7.0 BENCHMARK   â”‚
                                           â”‚  SETTINGS ADJ    â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<â”‚                  â”‚
       â”‚ Updated settings                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                              â”‚
       â”‚                                              â†“
       â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                                    â”‚ D11 Benchmarks â”‚
       â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                                              â”‚
       â”‚                                              â”‚ Thresholds
       â”‚                                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
       â”‚                                          (feeds into 4.0)
       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Processes Summary:
1. **1.0 Authenticate** - Multi-step login validation with security tracking
2. **2.0 Flood Risk Map Assessment** - GIS-based spatial analysis
3. **3.0 Generating Reports and Certifications** - PDF generation and exports
4. **4.0 Flood Risk Monitoring** - Real-time API integration with AND-based risk logic
5. **5.0 User Management** - Registration, approval, profile management
6. **6.0 Activity History Management** - Audit logging and archiving
7. **7.0 Benchmark Settings Adjustment** - Configurable risk thresholds

### Data Stores:
- **D1** Users - Authentication & profiles
- **D2** Barangays - GIS boundaries (PostGIS MultiPolygon)
- **D3** Flood Susceptibilities - Hazard zones (VHF/HF/MF/LF)
- **D4** Assessment Records - Historical assessments
- **D5** Report Records - Generated reports log
- **D6** Certificate Records - Issued certificates log
- **D7** Rainfall Data - Real-time measurements (mm)
- **D8** Weather Data - Temperature, humidity, wind
- **D9** Tide Level Data - Sea level measurements (m)
- **D10** Flood Records - Historical flood events
- **D11** Benchmark Settings - Risk thresholds (singleton)
- **D12** User Activity Logs - Audit trail
- **D13** Login Attempts - Security tracking

---

## LEVEL 2 DFD - CORE PROCESSES

### 1.0 AUTHENTICATE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin/User  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Username, Password, IP
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  1.0 AUTHENTICATE                        â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1.1 Validate Login Credentials                    â”‚ â”‚
â”‚  â”‚                                                     â”‚ â”‚
â”‚  â”‚  Username, Password, IP â”€â”€â†’ [Verify] â”€â”€â†’ Token    â”‚ â”‚
â”‚  â”‚                                â†“                    â”‚ â”‚
â”‚  â”‚                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚ â”‚
â”‚  â”‚                           â”‚D1 Users â”‚               â”‚ â”‚
â”‚  â”‚                           â”‚D13 Loginâ”‚               â”‚ â”‚
â”‚  â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                â†“ Auth token              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1.2 Manage User Session                            â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  Token, Activity â”€â”€â†’ [Session Manager] â”€â”€â†’ Status  â”‚ â”‚
â”‚  â”‚                           â†•                          â”‚ â”‚
â”‚  â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚
â”‚  â”‚                      â”‚D1 Users â”‚                     â”‚ â”‚
â”‚  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1.3 Track Login Attempts                            â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  Attempt Details â”€â”€â†’ [Logger] â”€â”€â†’ Security Alerts   â”‚ â”‚
â”‚  â”‚                        â†“                              â”‚ â”‚
â”‚  â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚ â”‚
â”‚  â”‚                   â”‚D13 Loginâ”‚                         â”‚ â”‚
â”‚  â”‚                   â”‚ Attemptsâ”‚                         â”‚ â”‚
â”‚  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  1.4 Enforce Access Control                          â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  User Role, Resource â”€â”€â†’ [Check] â”€â”€â†’ Grant/Deny     â”‚ â”‚
â”‚  â”‚                            â†‘                          â”‚ â”‚
â”‚  â”‚                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚ â”‚
â”‚  â”‚                       â”‚D1 Users â”‚                     â”‚ â”‚
â”‚  â”‚                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ Session token
                       â†“
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚ Authenticatedâ”‚
                â”‚    Session   â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Features:**
- Password hash verification (PBKDF2)
- Failed login tracking (lockout after 5 attempts in 30 min)
- Session management with 24-hour timeout
- Role-based access control

---

### 2.0 FLOOD RISK MAP ASSESSMENT

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     User     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Map request (viewport, zoom)
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               2.0 FLOOD RISK MAP ASSESSMENT                 â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2.1 Load GIS Layers                                  â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  Map Viewport â”€â”€â†’ [Query] â”€â”€â†’ GeoJSON Features       â”‚ â”‚
â”‚  â”‚                      â†“                                 â”‚ â”‚
â”‚  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚ â”‚
â”‚  â”‚              â”‚ D2 Barangays  â”‚                         â”‚ â”‚
â”‚  â”‚              â”‚ D3 Flood Zonesâ”‚                         â”‚ â”‚
â”‚  â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                           â†“ GeoJSON layers                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  2.2 Perform Spatial Query                          â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Lat/Lon â”€â”€â†’ [ST_Intersects] â”€â”€â†’ Barangay, Zone    â”‚  â”‚
â”‚  â”‚                    â†‘                                 â”‚  â”‚
â”‚  â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚  â”‚
â”‚  â”‚            â”‚ D2 Barangays  â”‚                         â”‚  â”‚
â”‚  â”‚            â”‚ D3 Flood Zonesâ”‚                         â”‚  â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                       â†“ Location + Hazard Code            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2.3 Calculate Risk Assessment                       â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  Hazard Code â”€â”€â†’ [Map Risk] â”€â”€â†’ Risk + Recommend.   â”‚ â”‚
â”‚  â”‚    (VHF/HF/MF/LF)      â†‘                             â”‚ â”‚
â”‚  â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚ â”‚
â”‚  â”‚                  â”‚D3 Flood â”‚                          â”‚ â”‚
â”‚  â”‚                  â”‚  Zones  â”‚                          â”‚ â”‚
â”‚  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                       â†“ Complete assessment               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  2.4 Record Assessment Activity                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  User ID, Location, Results â”€â”€â†’ [Save] â”€â”€â†’ Record IDâ”‚ â”‚
â”‚  â”‚                                    â†“                  â”‚ â”‚
â”‚  â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚ â”‚
â”‚  â”‚                          â”‚D4 Assessmentsâ”‚             â”‚ â”‚
â”‚  â”‚                          â”‚D12 Activity  â”‚             â”‚ â”‚
â”‚  â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ Risk map + assessment details
                         â†“
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚     User    â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Features:**
- PostGIS spatial queries (ST_Intersects)
- GeoJSON serialization for Leaflet.js
- MGB hazard classification (VHF, HF, MF, LF)
- Activity logging for compliance

---

### 4.0 FLOOD RISK AND FLOOD RECORD MONITORING

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Open-Meteo API â”‚         â”‚WorldTides API  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ Rainfall data            â”‚ Tide data
         â†“                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          4.0 FLOOD RISK MONITORING                       â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4.1 Fetch External API Data                       â”‚ â”‚
â”‚  â”‚                                                     â”‚ â”‚
â”‚  â”‚  Coordinates + API Keys â”€â”€â†’ [HTTP GET] â”€â”€â†’ JSON   â”‚ â”‚
â”‚  â”‚                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                        â†“ Raw API responses              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4.2 Process and Store Sensor Data                 â”‚ â”‚
â”‚  â”‚                                                      â”‚ â”‚
â”‚  â”‚  JSON â”€â”€â†’ [Parse & Validate] â”€â”€â†’ Normalized Data   â”‚ â”‚
â”‚  â”‚                      â†“                               â”‚ â”‚
â”‚  â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚ â”‚
â”‚  â”‚          â”‚ D7 Rainfall         â”‚                    â”‚ â”‚
â”‚  â”‚          â”‚ D8 Weather          â”‚                    â”‚ â”‚
â”‚  â”‚          â”‚ D9 Tide Levels      â”‚                    â”‚ â”‚
â”‚  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                        â†“ Current readings                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4.3 Calculate Real-time Risk Levels                â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  Rainfall + Tide â”€â”€â†’ [AND Logic] â”€â”€â†’ Risk Level     â”‚ â”‚
â”‚  â”‚         â†‘                  â†‘                          â”‚ â”‚
â”‚  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚ â”‚
â”‚  â”‚    â”‚D7 D9   â”‚      â”‚D11       â”‚                      â”‚ â”‚
â”‚  â”‚    â”‚Sensor  â”‚      â”‚Benchmarksâ”‚                      â”‚ â”‚
â”‚  â”‚    â”‚Data    â”‚      â”‚          â”‚                      â”‚ â”‚
â”‚  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  âš ï¸ UNIQUE ALGORITHM: AND-Based Risk Calculation     â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚ â”‚
â”‚  â”‚  IF (rainfall â‰¥ high_threshold AND tide â‰¥ high)     â”‚ â”‚
â”‚  â”‚     THEN "High Risk" (RED)                           â”‚ â”‚
â”‚  â”‚  ELSE IF (rainfall â‰¥ moderate AND tide â‰¥ moderate)  â”‚ â”‚
â”‚  â”‚     THEN "Moderate Risk" (ORANGE)                    â”‚ â”‚
â”‚  â”‚  ELSE "Low Risk" (YELLOW)                            â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚  Both conditions must be met simultaneously!         â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â†“ Risk assessment                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4.4 Manage Flood Event Records                      â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  Event Details â”€â”€â†’ [Save] â”€â”€â†’ Historical Record      â”‚ â”‚
â”‚  â”‚                      â†“                                 â”‚ â”‚
â”‚  â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚ â”‚
â”‚  â”‚                â”‚D10 Flood â”‚                            â”‚ â”‚
â”‚  â”‚                â”‚ Records  â”‚                            â”‚ â”‚
â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  4.5 Generate Monitoring Dashboard                   â”‚ â”‚
â”‚  â”‚                                                        â”‚ â”‚
â”‚  â”‚  Real-time + Historical â”€â”€â†’ [Visualize] â”€â”€â†’ Dashboardâ”‚ â”‚
â”‚  â”‚           â†‘                                            â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚ â”‚
â”‚  â”‚   â”‚ D7, D8, D9, D10â”‚                                  â”‚ â”‚
â”‚  â”‚   â”‚ All sensor dataâ”‚                                  â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ Dashboard + Alerts
                          â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚     User     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Features:**
- Free Open-Meteo API (no key required)
- Authenticated WorldTides API
- AND-based risk logic (both parameters must meet threshold)
- Configurable benchmarks via admin interface
- 3-hour update interval with 1-year data retention

---

## LEVEL 3 DFD - CRITICAL SUB-PROCESSES

### 1.1 VALIDATE LOGIN CREDENTIALS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ Username: "admin"
       â”‚ Password: "******"
       â”‚ IP: "192.168.1.10"
       â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                1.1 VALIDATE LOGIN CREDENTIALS                â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 1.1.1 Receive Login Request                            â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚   Input: Username, Password, IP                        â”‚ â”‚
â”‚  â”‚     â†“                                                   â”‚ â”‚
â”‚  â”‚   [Capture Request Data]                               â”‚ â”‚
â”‚  â”‚     â†“                                                   â”‚ â”‚
â”‚  â”‚   Output: Login Attempt Object                         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                         â†“                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.2 Query User Database                            â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   Username: "admin" â”€â”€â†’ [SQL Query] â”€â”€â†’ User Record  â”‚  â”‚
â”‚  â”‚                            â†‘                          â”‚  â”‚
â”‚  â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚  â”‚
â”‚  â”‚                      â”‚ D1 Users â”‚                     â”‚  â”‚
â”‚  â”‚                      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â” â”‚                     â”‚  â”‚
â”‚  â”‚                      â”‚ â”‚admin â”‚ â”‚ â† SELECT * WHERE   â”‚  â”‚
â”‚  â”‚                      â”‚ â””â”€â”€â”€â”€â”€â”€â”˜ â”‚   username='admin' â”‚  â”‚
â”‚  â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“ User found                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.3 Verify Password Hash                           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   Submitted: "******"     Stored: "pbkdf2_sha256$..." â”‚  â”‚
â”‚  â”‚       â†“                       â†“                       â”‚  â”‚
â”‚  â”‚   [Hash Algorithm]    [Compare Hashes]               â”‚  â”‚
â”‚  â”‚       â†“                       â†“                       â”‚  â”‚
â”‚  â”‚   Hash A  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Match? TRUE/FALSE        â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“ Password valid                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.4 Check Account Status                           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   User Record â”€â”€â†’ [Check Flags]                      â”‚  â”‚
â”‚  â”‚                       â†“                               â”‚  â”‚
â”‚  â”‚                   is_active? âœ“                        â”‚  â”‚
â”‚  â”‚                   is_approved? âœ“                      â”‚  â”‚
â”‚  â”‚                       â†“                               â”‚  â”‚
â”‚  â”‚                   Output: ACTIVE                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“ Account active                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.5 Check Lockout Status                           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   Username + IP â”€â”€â†’ [Query Failed Attempts]          â”‚  â”‚
â”‚  â”‚                          â†‘                            â”‚  â”‚
â”‚  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚  â”‚
â”‚  â”‚                    â”‚ D13 Login    â”‚                   â”‚  â”‚
â”‚  â”‚                    â”‚ Attempts     â”‚                   â”‚  â”‚
â”‚  â”‚                    â”‚ Last 30 min  â”‚                   â”‚  â”‚
â”‚  â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚
â”‚  â”‚                          â†“                            â”‚  â”‚
â”‚  â”‚                    Failed count < 5?                  â”‚  â”‚
â”‚  â”‚                          â†“                            â”‚  â”‚
â”‚  â”‚                    Output: NOT LOCKED                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“ Not locked                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.6 Generate Session Token                         â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   User ID: 1 â”€â”€â†’ [Create JWT]                        â”‚  â”‚
â”‚  â”‚                      â†“                                â”‚  â”‚
â”‚  â”‚   Token: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."   â”‚  â”‚
â”‚  â”‚   Cookie: "sessionid=abc123xyz; Max-Age=86400"       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â†“ Session created                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 1.1.7 Record Login Attempt                           â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚   Username: "admin"                                   â”‚  â”‚
â”‚  â”‚   IP: "192.168.1.10"     â”€â”€â†’ [INSERT]                â”‚  â”‚
â”‚  â”‚   Success: TRUE                  â†“                    â”‚  â”‚
â”‚  â”‚   Timestamp: 2025-12-02 14:30  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚  â”‚
â”‚  â”‚                                â”‚ D13 Login    â”‚      â”‚  â”‚
â”‚  â”‚                                â”‚ Attempts     â”‚      â”‚  â”‚
â”‚  â”‚                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ âœ“ Login Success
                          â”‚ Token: "eyJhbGciO..."
                          â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚     User     â”‚
                   â”‚ (Logged In)  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Security Features:**
- PBKDF2 password hashing with salt
- Account lockout after 5 failed attempts (30-minute window)
- JWT session tokens (24-hour expiration)
- IP address tracking
- Comprehensive login attempt logging

---

### 4.3 CALCULATE REAL-TIME RISK LEVELS

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           4.3 CALCULATE REAL-TIME RISK LEVELS              â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.1 Retrieve Latest Rainfall Data                  â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Query: Latest record â”€â”€â†’ [SELECT] â”€â”€â†’ 52.3 mm     â”‚ â”‚
â”‚  â”‚                               â†‘                       â”‚ â”‚
â”‚  â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚                         â”‚D7 Rain   â”‚                  â”‚ â”‚
â”‚  â”‚                         â”‚  Data    â”‚                  â”‚ â”‚
â”‚  â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.2 Retrieve Latest Tide Data                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Query: Latest record â”€â”€â†’ [SELECT] â”€â”€â†’ 1.6 m       â”‚ â”‚
â”‚  â”‚                               â†‘                       â”‚ â”‚
â”‚  â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚ â”‚
â”‚  â”‚                         â”‚D9 Tide   â”‚                  â”‚ â”‚
â”‚  â”‚                         â”‚  Data    â”‚                  â”‚ â”‚
â”‚  â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.3 Load Benchmark Thresholds                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Query: Settings (pk=1) â”€â”€â†’ [SELECT]               â”‚ â”‚
â”‚  â”‚                                 â†“                     â”‚ â”‚
â”‚  â”‚                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚ â”‚
â”‚  â”‚                         â”‚D11 Benchmarksâ”‚              â”‚ â”‚
â”‚  â”‚                         â”‚ (Singleton)  â”‚              â”‚ â”‚
â”‚  â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚ â”‚
â”‚  â”‚                                 â†“                     â”‚ â”‚
â”‚  â”‚   Thresholds Retrieved:                              â”‚ â”‚
â”‚  â”‚   â€¢ rainfall_moderate: 30 mm                         â”‚ â”‚
â”‚  â”‚   â€¢ rainfall_high: 50 mm                             â”‚ â”‚
â”‚  â”‚   â€¢ tide_moderate: 1.0 m                             â”‚ â”‚
â”‚  â”‚   â€¢ tide_high: 1.5 m                                 â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.4 Apply AND-Based Risk Logic                     â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Current Values:                                    â”‚ â”‚
â”‚  â”‚   â€¢ Rainfall: 52.3 mm                                â”‚ â”‚
â”‚  â”‚   â€¢ Tide: 1.6 m                                      â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚ â”‚
â”‚  â”‚   â”‚ STEP 1: Check HIGH RISK         â”‚                â”‚ â”‚
â”‚  â”‚   â”‚                                  â”‚                â”‚ â”‚
â”‚  â”‚   â”‚ 52.3 â‰¥ 50  AND  1.6 â‰¥ 1.5       â”‚                â”‚ â”‚
â”‚  â”‚   â”‚   âœ“ TRUE        âœ“ TRUE          â”‚                â”‚ â”‚
â”‚  â”‚   â”‚                                  â”‚                â”‚ â”‚
â”‚  â”‚   â”‚ BOTH conditions met!             â”‚                â”‚ â”‚
â”‚  â”‚   â”‚ â†’ RETURN: "High Risk" ğŸ”´        â”‚                â”‚ â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   (Skip MODERATE and LOW checks)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.5 Determine Risk Color                           â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Risk Level: "High Risk" â”€â”€â†’ [Map Color]           â”‚ â”‚
â”‚  â”‚                                    â†“                  â”‚ â”‚
â”‚  â”‚                              Color: RED               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                 â†“                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ 4.3.6 Format Risk Output                             â”‚ â”‚
â”‚  â”‚                                                       â”‚ â”‚
â”‚  â”‚   Output Object:                                     â”‚ â”‚
â”‚  â”‚   {                                                  â”‚ â”‚
â”‚  â”‚     "risk_level": "High Risk",                       â”‚ â”‚
â”‚  â”‚     "color": "red",                                  â”‚ â”‚
â”‚  â”‚     "rainfall_mm": 52.3,                             â”‚ â”‚
â”‚  â”‚     "tide_m": 1.6,                                   â”‚ â”‚
â”‚  â”‚     "timestamp": "2025-12-02T14:30:00Z"              â”‚ â”‚
â”‚  â”‚   }                                                  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ Risk assessment object
                          â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Dashboard   â”‚
                   â”‚   (RED)      â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Process Summary:**
1. Fetch latest sensor readings from database
2. Load configurable thresholds from benchmark settings
3. Apply AND-based logic (both conditions must be met)
4. Map risk level to color code
5. Format output for UI display

---

## LEVEL 4 DFD - AND-BASED RISK LOGIC

### 4.3.4 APPLY AND-BASED RISK LOGIC (THE UNIQUE ALGORITHM)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            4.3.4 AND-BASED RISK CALCULATION LOGIC               â”‚
â”‚                                                                 â”‚
â”‚  INPUT DATA:                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚ Current Rainfall â”‚        â”‚  Current Tide    â”‚              â”‚
â”‚  â”‚   52.3 mm        â”‚        â”‚    1.6 m         â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚           â”‚                           â”‚                         â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                       â†“                                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚           â”‚  Load Thresholds from  â”‚                            â”‚
â”‚           â”‚  D11 Benchmark Settingsâ”‚                            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                       â†“                                         â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚           â”‚ rainfall_moderate: 30mmâ”‚                            â”‚
â”‚           â”‚ rainfall_high: 50mm    â”‚                            â”‚
â”‚           â”‚ tide_moderate: 1.0m    â”‚                            â”‚
â”‚           â”‚ tide_high: 1.5m        â”‚                            â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚                       â†“                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ STEP 1: Check HIGH RISK (Both conditions must be TRUE) â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   Rainfall â‰¥ High Threshold?    Tide â‰¥ High Threshold? â”‚   â”‚
â”‚  â”‚      52.3mm â‰¥  50mm                1.6m  â‰¥  1.5m        â”‚   â”‚
â”‚  â”‚        âœ“ TRUE              AND       âœ“ TRUE            â”‚   â”‚
â”‚  â”‚                             â†“                           â”‚   â”‚
â”‚  â”‚                    BOTH CONDITIONS MET                  â”‚   â”‚
â”‚  â”‚                             â†“                           â”‚   â”‚
â”‚  â”‚                      RETURN: HIGH RISK ğŸ”´              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                         â”‚
â”‚                  Exit (Skip other checks)                       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ STEP 2: Check MODERATE RISK (if HIGH not met)          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   Rainfall â‰¥ Moderate?        Tide â‰¥ Moderate?         â”‚   â”‚
â”‚  â”‚      35mm  â‰¥  30mm               1.1m  â‰¥  1.0m         â”‚   â”‚
â”‚  â”‚        âœ“ TRUE            AND       âœ“ TRUE              â”‚   â”‚
â”‚  â”‚                             â†“                           â”‚   â”‚
â”‚  â”‚                    BOTH CONDITIONS MET                  â”‚   â”‚
â”‚  â”‚                             â†“                           â”‚   â”‚
â”‚  â”‚                   RETURN: MODERATE RISK ğŸŸ              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                         â”‚
â”‚                  Exit (Skip LOW check)                          â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ STEP 3: Default to LOW RISK (if neither met)           â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚   If HIGH not met AND MODERATE not met                 â”‚   â”‚
â”‚  â”‚                    â†“                                    â”‚   â”‚
â”‚  â”‚             RETURN: LOW RISK ğŸŸ¡                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  EXAMPLE SCENARIOS:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âœ“ Scenario A: rain=52mm, tide=1.6m â†’ HIGH RISK ğŸ”´      â”‚  â”‚
â”‚  â”‚               Both conditions met for HIGH               â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ âœ— Scenario B: rain=52mm, tide=1.2m â†’ LOW RISK ğŸŸ¡       â”‚  â”‚
â”‚  â”‚               High rainfall BUT tide not high enough     â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ âœ“ Scenario C: rain=35mm, tide=1.1m â†’ MODERATE ğŸŸ        â”‚  â”‚
â”‚  â”‚               Both conditions met for MODERATE           â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ âœ— Scenario D: rain=35mm, tide=0.8m â†’ LOW RISK ğŸŸ¡       â”‚  â”‚
â”‚  â”‚               Moderate rainfall BUT tide not moderate    â”‚  â”‚
â”‚  â”‚                                                          â”‚  â”‚
â”‚  â”‚ âœ— Scenario E: rain=25mm, tide=0.5m â†’ LOW RISK ğŸŸ¡       â”‚  â”‚
â”‚  â”‚               Neither condition met                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  WHY AND-BASED LOGIC?                                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                         â”‚
â”‚  â€¢ Prevents false alarms from single high reading              â”‚
â”‚  â€¢ Reflects real flood risk (needs BOTH factors)               â”‚
â”‚  â€¢ More accurate than OR-based or averaging methods            â”‚
â”‚  â€¢ Aligns with meteorological flood prediction models          â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ Risk Level + Color
                          â†“
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  Dashboard UI    â”‚
                   â”‚  Shows: HIGH RISKâ”‚
                   â”‚  Color: RED      â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Implementation Code:
```python
def get_combined_risk_level(rainfall_mm, tide_m):
    """
    Determine combined risk level based on AND-based threshold logic.
    Both rainfall AND tide must meet thresholds to trigger that risk level.
    """
    settings = BenchmarkSettings.get_settings()
    
    # Check HIGH RISK: Both rainfall AND tide must meet high thresholds
    if rainfall_mm >= settings.rainfall_high_threshold and tide_m >= settings.tide_high_threshold:
        return "High Risk", "red"
    
    # Check MODERATE RISK: Both rainfall AND tide must meet moderate thresholds
    if rainfall_mm >= settings.rainfall_moderate_threshold and tide_m >= settings.tide_moderate_threshold:
        return "Moderate Risk", "orange"
    
    # Otherwise: LOW RISK
    return "Low Risk", "yellow"
```

---

## DATA DICTIONARY

### D1 - Users (CustomUser)
| Field | Type | Description |
|-------|------|-------------|
| id | Integer PK | Unique user identifier |
| username | String(150) | Login username (unique) |
| password | String(128) | Hashed password (PBKDF2) |
| email | EmailField | User email address |
| staff_id | String(10) | Auto-generated staff ID (e.g., 20250001) |
| is_active | Boolean | Account activation status |
| is_approved | Boolean | Admin approval status (pending by default) |
| is_staff | Boolean | Staff access flag |
| is_superuser | Boolean | Superuser flag |
| position | String(50) | Job position (predefined choices) |
| contact_number | String(11) | Phone number |
| profile_image | ImageField | Profile photo (max 5MB, 4000x4000px) |
| date_joined | DateTime | Registration timestamp |
| last_login | DateTime | Last successful login timestamp |

### D2 - Barangays
| Field | Type | Description |
|-------|------|-------------|
| id | String(9) PK | PSGC barangay code |
| name | String(100) | Barangay name |
| parent_id | String(8) | Parent municipality code |
| geometry | MultiPolygon | Barangay boundary (PostGIS geometry) |

### D3 - Flood Susceptibilities
| Field | Type | Description |
|-------|------|-------------|
| id | Integer PK | Record identifier |
| lgu | String(20) | LGU name (Silay City) |
| psgc_lgu | String(8) | PSGC LGU code (64526000) |
| haz_code | String(3) | Hazard code: VHF, HF, MF, LF |
| haz_desc | String(30) | Hazard description (auto-generated) |
| haz_area_ha | Decimal(15,8) | Hazard area in hectares |
| geometry | MultiPolygon | Flood zone boundary (PostGIS geometry) |

**Hazard Code Definitions:**
- **VHF**: Very High - >2m flood height, >3 days duration
- **HF**: High - 1-2m flood height, >3 days duration  
- **MF**: Moderate - 0.5-1m flood height, 1-3 days duration
- **LF**: Low - <0.5m flood height, <1 day duration

### D7 - Rainfall Data
| Field | Type | Description |
|-------|------|-------------|
| id | Integer PK | Record identifier |
| value_mm | Float | Rainfall measurement in millimeters |
| timestamp | DateTime | Measurement timestamp |
| station_name | String(100) | Weather station name (Silay City) |

### D9 - Tide Level Data
| Field | Type | Description |
|-------|------|-------------|
| id | Integer PK | Record identifier |
| height_m | Float | Tide height in meters |
| timestamp | DateTime | Measurement timestamp |
| station_name | String(100) | Tide station name (Cebu) |

### D11 - Benchmark Settings (Singleton)
| Field | Type | Description | Default |
|-------|------|-------------|---------|
| id | Integer PK | Settings ID (always 1) | 1 |
| rainfall_moderate_threshold | Float | Moderate risk rainfall (mm) | 30 |
| rainfall_high_threshold | Float | High risk rainfall (mm) | 50 |
| tide_moderate_threshold | Float | Moderate risk tide (m) | 1.0 |
| tide_high_threshold | Float | High risk tide (m) | 1.5 |
| combined_risk_method | String(20) | Risk calculation method | max |
| created_at | DateTime | Settings creation timestamp | Auto |
| updated_at | DateTime | Last update timestamp | Auto |
| updated_by | String(100) | Admin username who last updated | - |

**Risk Calculation Methods:**
- **max**: Maximum of both (currently AND-based)
- **equal**: 50% rainfall, 50% tide
- **rainfall_priority**: 80% rainfall, 20% tide
- **tide_priority**: 20% rainfall, 80% tide

### D13 - Login Attempts
| Field | Type | Description |
|-------|------|-------------|
| id | Integer PK | Attempt identifier |
| username | String(150) | Username attempted |
| ip_address | GenericIPAddress | Source IP address |
| timestamp | DateTime | Attempt timestamp |
| success | Boolean | Success/failure status |

**Security Rule:** Account locked after 5 failed attempts within 30 minutes from same IP.

---

## SUMMARY

This streamlined DFD documentation focuses on:

### **What's Included:**
âœ… **Context Diagram** - System boundaries  
âœ… **Level 1** - All 7 major processes with visual flows  
âœ… **Level 2** - 3 core processes expanded (Authentication, GIS Assessment, Monitoring)  
âœ… **Level 3** - 2 critical sub-processes (Login validation, Risk calculation)  
âœ… **Level 4** - 1 unique algorithm (AND-based risk logic)  
âœ… **Data Dictionary** - Key data stores only  

### **What Makes This System Unique:**
1. **AND-Based Flood Risk Logic** - Both rainfall AND tide must meet thresholds (prevents false alarms)
2. **PostGIS Spatial Queries** - ST_Intersects for real-time location-based risk assessment
3. **Multi-Source API Integration** - Open-Meteo (free) + WorldTides (authenticated)
4. **Configurable Benchmarks** - Admin can adjust thresholds without code changes
5. **Comprehensive Security** - Multi-step authentication with lockout protection

### **Documentation Size:**
- **Original**: ~1,800 lines with all atomic processes
- **Streamlined**: ~800 lines focused on essential logic
- **Reduction**: 55% smaller, 100% of critical information retained

This version is ideal for:
- Academic thesis documentation
- System presentations
- Technical reviews
- Developer onboarding
- Client demonstrations
